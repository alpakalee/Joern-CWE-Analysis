# CWE-190: 정수 오버플로우 (Integer Overflow or Wraparound) - Joern 쿼리 문제점

## 📌 개요  
CWE-190은 **정수 연산 시 데이터 타입의 최대/최소 범위를 초과하여 잘못된 결과를 초래하는 취약점**입니다.  
이 취약점을 악용하면 공격자가 **정수 값 조작을 통해 프로그램의 오작동을 유발하거나, 예측할 수 없는 동작을 수행하도록 만들 수 있습니다.**

## 🛠 주요 원인  
- 연산 수행 전 최대/최소값 검증 부족  
- 입력값이 예상보다 클 경우 오버플로우 발생 가능  
- 데이터 타입 크기 제한을 고려하지 않고 연산 수행  

## 🕵️‍♂️ Joern 쿼리 문제점  
현재 Joern 쿼리는 **곱셈 연산(`data * data`)이 발생하는 경우를 탐색한 후, `data`가 검증되지 않은 상태에서 연산되는지 확인**하는 방식입니다.  
하지만 특정 경우, **Joern이 `data = 2`와 같은 값이 안전하다고 간주하여 위험 사례를 탐지하지 않는 문제**가 발생할 수 있습니다.

### 🔹 의문점 정리  
- **현재의 쿼리로 탐지되지 않는 특수 사례(G2B)가 존재**  
- 정적 분석 도구(Joern)가 `data = 2` 값을 안전하다고 판단하여 **위험 사례를 간주하지 않을 가능성**  
- `data` 값이 고정된 경우, 분석 도구가 오버플로우 발생 여부를 탐지하지 못할 수 있음  

## ✅ 개선 방안  
- `data` 값이 고정되어 있더라도 **모든 곱셈 연산을 대상으로 탐색**  
- 최대값 검증(`if (data <= MAX)`)이 없을 경우만 위험 사례로 간주하도록 개선  
- **정적 분석 도구의 한계를 고려하여, 특정 값이 안전하다고 간주되는 문제 해결**  