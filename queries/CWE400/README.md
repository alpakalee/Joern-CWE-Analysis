# CWE-400: 리소스 고갈 (Resource Exhaustion) - Joern 쿼리 문제점

## 📌 개요  
CWE-400은 **입력값 검증 부족으로 인해 시스템 리소스를 과도하게 소비하는 취약점**입니다.  
이 취약점을 악용하면 공격자가 프로그램을 중단시키거나, 시스템 성능을 저하시키는 공격을 수행할 수 있습니다.

## 🛠 주요 원인  
- `for` 루프에서 반복 횟수를 제한하는 검증 부족  
- 사용자의 입력값(`count`)을 직접 루프 조건에 사용  
- `count` 값이 너무 크거나 비정상적인 값이 입력될 경우, 프로그램이 무한 실행될 가능성  

## 🕵️‍♂️ Joern 쿼리 문제점  
현재 Joern 쿼리는 **모든 `for` 루프를 탐색한 후, `count` 변수를 포함하는 루프만 필터링**하는 방식입니다.  
그러나 **모든 `for` 루프를 탐색하는 과정에서, `count` 변수를 사용하는 모든 루프를 문제 대상으로 탐지**하기 때문에 **불필요한 탐지가 포함될 가능성이 있습니다.**

### 🔹 문제점 정리  
- `count`를 사용하는 모든 `for` 루프를 대상으로 탐색하여 **필요 없는 코드도 탐지됨**  
- 실제로 검증이 충분한 경우에도 탐지될 가능성 존재  
- `if (count >= min && count <= max)` 와 같은 **검증 로직을 추가 확인해야 함**

## ✅ 개선 방안  
- 쿼리에서 **검증 로직이 포함되지 않은 `for` 루프만 탐색**하도록 개선  
- `if` 문이 존재하고, `count` 값을 검증하는 로직이 있는 경우 제외하는 필터 추가  
- **불필요한 탐지 최소화 및 정확도 향상**